<Window x:Class="Banga_Photobooth.TemplateWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Choose Template" 
        WindowStyle="None"
        WindowState="Maximized"
        ResizeMode="NoResize"
        Background="White">

    <Window.Resources>
        <SolidColorBrush x:Key="PrimaryBrush" Color="#5B8DEE"/>
        <!-- Template Image Style -->
        <Style x:Key="TemplateImageStyle" TargetType="Image">
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Stretch" Value="Uniform"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" Opacity="0.2" BlurRadius="20" ShadowDepth="8"/>
                </Setter.Value>
            </Setter>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#5B8DEE" Opacity="0.6" BlurRadius="30" ShadowDepth="0"/>
                        </Setter.Value>
                    </Setter>
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" 
                                                To="1.05" Duration="0:0:0.2"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" 
                                                To="1.05" Duration="0:0:0.2"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" 
                                                To="1.0" Duration="0:0:0.2"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" 
                                                To="1.0" Duration="0:0:0.2"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- ScrollViewer Style for Hidden Scrollbars but Functional Touch -->
        <Style x:Key="TouchScrollViewer" TargetType="ScrollViewer">
            <Setter Property="PanningMode" Value="HorizontalOnly"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Hidden"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid>
                            <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                                  CanContentScroll="{TemplateBinding CanContentScroll}"
                                                  CanHorizontallyScroll="True"
                                                  CanVerticallyScroll="False"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- Admin/Settings Button (Top-Right Corner) -->
        <Button x:Name="SettingsButton" 
                Panel.ZIndex="200"
                HorizontalAlignment="Right" 
                VerticalAlignment="Top" 
                Margin="0,20,20,0"
                Width="60"
                Height="60"
                Background="Transparent"
                BorderThickness="0"
                Click="SettingsButton_Click"
                Visibility="Collapsed"> <!-- Hidden as requested, triggered by Logo gesture now -->
            <Button.Content>
                <Image Source="/Assets/settings_icon.png" Stretch="Uniform"/> 
            </Button.Content>
        </Button>

        <!-- Main Content -->
        <Grid Margin="0,60,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <TextBlock Grid.Row="0" 
                       Text="CHOOSE TEMPLATE" 
                       FontFamily="Assets/Fonts/#Poppins" 
                       FontWeight="Bold"
                       FontSize="60" 
                       Foreground="#333333"
                       HorizontalAlignment="Center"
                       Margin="0,0,0,10"/>

            <!-- Template Slider -->
            <Grid Grid.Row="1" VerticalAlignment="Center">
                <!-- Left Arrow -->
                <Button x:Name="ScrollLeftButton" 
                        HorizontalAlignment="Left" VerticalAlignment="Center"
                        Margin="20,0,0,0"
                        Background="Transparent" BorderThickness="0"
                        Click="ScrollLeftButton_Click"
                        Visibility="Hidden">
                    <TextBlock Text="❮" FontSize="60" Foreground="#888" FontWeight="Bold"/>
                </Button>

                <!-- Scrollable Area -->
                <ScrollViewer x:Name="TemplateScrollViewer"
                              Style="{StaticResource TouchScrollViewer}"
                              Margin="80,0,80,0"
                             HorizontalAlignment="Stretch"
                              VerticalAlignment="Center"
                              PreviewMouseWheel="TemplateScrollViewer_PreviewMouseWheel">
                    <StackPanel x:Name="TemplateStackPanel" 
                                Orientation="Horizontal"
                                VerticalAlignment="Center"/>
                </ScrollViewer>

                <!-- Right Arrow -->
                <Button x:Name="ScrollRightButton" 
                        HorizontalAlignment="Right" VerticalAlignment="Center"
                        Margin="0,0,20,0"
                        Background="Transparent" BorderThickness="0"
                        Click="ScrollRightButton_Click">
                    <TextBlock Text="❯" FontSize="60" Foreground="#888" FontWeight="Bold"/>
                </Button>
            </Grid>

            <!-- Footer -->
            <Grid Grid.Row="2" Margin="0,0,40,40">
                <TextBlock Text="Swipe to browse • Tap to select" 
                           FontFamily="Assets/Fonts/#Poppins"
                           FontSize="28" 
                           Foreground="#555555"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Bottom"
                           Margin="0,0,0,10"/>

                <!-- Countdown Timer (Replaces Next Button) -->
                <Border x:Name="SelectionTimerBorder"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom"
                        Background="White"
                        CornerRadius="50"
                        Width="100"
                        Height="100"
                        Margin="0,0,20,20">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" Opacity="0.2" BlurRadius="10" ShadowDepth="4"/>
                    </Border.Effect>
                                        <Grid>
                        <Ellipse Stroke="#E0E0E0" StrokeThickness="4"/>
                        <Path x:Name="CountdownProgress" 
                              Stroke="{StaticResource PrimaryBrush}" 
                              StrokeThickness="4"
                              StrokeStartLineCap="Round"
                              StrokeEndLineCap="Round"
                              Data="M 50,4 A 46,46 0 1 1 49.99,4"
                              StrokeDashArray="289"
                              StrokeDashOffset="0"/>
                        <TextBlock x:Name="SelectionCountdownText"
                                   Text="7"
                                   FontFamily="Assets/Fonts/#Poppins"
                                   FontWeight="Bold"
                                   FontSize="36"
                                   Foreground="{StaticResource PrimaryBrush}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                                        </Grid>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>
